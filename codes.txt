Sub stockticker():

For Each ws In Worksheets

Dim stock_name As String
Dim stock_volume As Double
Dim column As Integer

lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row
stock_volume = 0
column = 2

ws.Range("K1").Value = "ticker"
ws.Range("L1").Value = "total total volume"

For i = 2 To lastrow

If ws.Cells(i, 1).Value <> ws.Cells(i + 1, 1).Value Then

'assigning values to variables
stock_name = ws.Cells(i, 1).Value
stock_volume = stock_volume + ws.Cells(i, 7).Value

'assigning varaiables to cells
ws.Range("K" & column).Value = stock_name
ws.Range("L" & column).Value = stock_volume

'resets variables
stock_volume = 0
column = column + 1

Else

stock_volume = stock_volume + ws.Cells(i, 7).Value

End If


Next i

Next ws

End Sub

